<!DOCTYPE html>
<html lang="nl">
<link href='https://fonts.googleapis.com/css?family=Roboto Flex' rel='stylesheet'>

<head>
  <title>Vlasblauw</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/images/favicon.svg" />
  <link rel="shortcut icon" href="/images/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="Vlasblauw" />
  <link rel="manifest" href="/images/site.webmanifest" />
  <style>
    #projects-container {
      max-width: 1100px;
      margin: 40px auto;
      padding: 0 12px;
      box-sizing: border-box;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 32px;
      align-items: start;
    }

    /* project card */
    .project {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .project .project-thumbnail,
    .project .project-thumbnail img {
      max-height: 700px;
      display: block;
      align-self: center;
    }

    .project .project-header {
      display: flex;
      align-items: baseline;
      gap: 12px;
    }

    .project .project-description {
      margin: 0;
      color: #333;
      line-height: 1.4;
      align-self: justify;
    }

    /* responsive: single column on small screens */
    @media (max-width: 900px) {
      #projects-container {
        grid-template-columns: 1fr;
        gap: 20px;
        margin: 24px auto;
      }
    }

    /* optional: tighter spacing on very small screens */
    @media (max-width: 480px) {
      #projects-container {
        padding: 0 8px;
      }

      .project {
        gap: 8px;
      }
    }
  </style>
</head>

<body>
  <div class="topnav">
    <div class="nav-container">
      <div class="nav-left">
        <ul>
          <li><img class="logo" src="images/logo-nowhites.jpg" alt="Vlasblauw Logo"></li>
          <li><a href="vlasblauw.html">vlasblauw</a></li>
          <li><a class="active" href="#">projecten</a></li>
          <li><a href="contact.html">contact</a></li>
        </ul>
      </div>
      <div class="nav-right">
        <ul>
          <li><a href="https://www.instagram.com/vlasblauw/">
              <img class="social" src="images/icons/icons8-instagram-26.png">
            </a></li>
          <li><a href="mailto:vlasblauw@info.be">
              <img class="social"
                src="images/icons/email-envelope-outline-shape-with-rounded-corners_icon-icons.com_56530.png">
            </a></li>
        </ul>
      </div>
    </div>
  </div>

  <div id="projects-container"></div>

  <div class="bottomnav">
    <div class="nav-container">
      <p>info@vlasblauw.be | 04123456</p>
    </div>
  </div>

  <script>
    (async function () {
      const container = document.getElementById('projects-container');

      function joinPath(a, b) {
        return String(a).replace(/\/+$/, '') + '/' + String(b).replace(/^\/+/, '');
      }

      function resolveThumb(it) {
        let t = String(it.thumbnail || '').trim();
        const looksAbsolute = /^\/|^[a-zA-Z]+:\/\//.test(t);
        const hasProjectsPrefix = t.startsWith('projects/');
        if (!t) {
          //Fallback to first image of images array if present
          if (Array.isArray(it.images) && it.images.length) t = it.images[0];
        }
        if (!t) return '';
        if (looksAbsolute || hasProjectsPrefix) return t.replace(/^\/+/, '');
        const base = it.href || `projects/${it.folder}/`;
        return joinPath(base, t);
      }

      try {
        const res = await fetch('./projects.json', { cache: 'no-cache' });
        if (!res.ok) throw new Error('projects.json not found');
        const items = await res.json();
        if (!Array.isArray(items) || !items.length) {
          container.innerHTML = '<p style="font-style:italic;text-align:center;margin:60px auto;">Kan projecten niet laden.</p>';
          return;
        }

        //Build DOM for each project
        items.forEach((it) => {
          const projectEl = document.createElement('section');
          projectEl.className = 'project';

          //Thumbnail (linked to project viewer)
          const thumbDiv = document.createElement('div');
          thumbDiv.className = 'project-thumbnail';
          const link = document.createElement('a');
          const folderName = encodeURIComponent(it.folder || (it.href || '').replace(/\/$/, '').split('/').pop() || '');
          link.href = `project_thumbnail.html?folder=${folderName}`;
          const img = document.createElement('img');
          const thumbSrc = resolveThumb(it);
          if (thumbSrc) img.src = thumbSrc;
          img.alt = it.title || it.folder || '';
          link.appendChild(img);
          thumbDiv.appendChild(link);

          //Header
          const header = document.createElement('div');
          header.className = 'project-header';
          const h2 = document.createElement('h2');
          h2.textContent = it.title;
          const year = document.createElement('div');
          year.className = 'year';
          year.textContent = it.year;
          header.appendChild(h2);
          header.appendChild(year);

          //Description
          const p = document.createElement('p');
          p.className = 'project-description';
          p.textContent = it.description;

          projectEl.appendChild(thumbDiv);
          projectEl.appendChild(header);
          projectEl.appendChild(p);
          container.appendChild(projectEl);
        });
      } catch (err) {
        console.warn(err);
        container.innerHTML = '<p style="font-style:italic;text-align:center;margin:60px auto;">Kan projecten niet laden.</p>';
      }
    })();
  </script>

</body>

</html>